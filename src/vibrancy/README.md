Adapted from https://github.com/killercup/vibrant-rs. MIT License